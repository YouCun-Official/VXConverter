# PDF转Word功能 - 快速部署指南

## 🚀 快速开始

### 前置条件

- ✅ 已开通微信云开发
- ✅ 已安装微信开发者工具
- ✅ Node.js 环境（用于安装依赖）

## 📦 部署步骤

### 1️⃣ 安装云函数依赖

**方式一：使用微信开发者工具（推荐）**

1. 打开微信开发者工具
2. 找到 `cloudfunctions/pdfToWord` 文件夹
3. 右键点击该文件夹
4. 选择 **"上传并部署：云端安装依赖"**
5. 等待上传和依赖安装完成（可能需要几分钟）

**方式二：本地安装后上传**

```bash
# 进入云函数目录
cd cloudfunctions/pdfToWord

# 安装依赖
npm install

# 返回开发者工具，右键上传云函数
```

### 2️⃣ 验证云函数部署

1. 在微信开发者工具左侧，点击 **"云开发"** 控制台
2. 进入 **"云函数"** 标签
3. 确认看到 `pdfToWord` 函数
4. 状态显示为 **"已部署"**

### 3️⃣ 配置页面路由

**这一步已自动完成！**

✅ `app.json` 已添加页面路由
✅ `converter/index.js` 已更新导航方法

### 4️⃣ 测试功能

1. **在开发者工具中测试**
   - 点击工具栏的"编译"按钮
   - 进入"转换器"主页
   - 滚动到"PDF转其他"板块
   - 点击"PDF转Word"

2. **选择测试文件**
   - 准备一个文本型PDF文件（非扫描版）
   - 文件大小建议 < 5MB（首次测试）
   - 点击"选择PDF文件"

3. **执行转换**
   - 调整转换选项（可选）
   - 点击"开始转换为Word"
   - 等待转换完成

4. **验证结果**
   - 转换成功后会弹出提示
   - 点击"打开文档"查看Word文件
   - 检查文本内容是否正确提取

## 🔍 故障排查

### 问题1: 云函数上传失败

**可能原因**：
- 网络问题
- 云开发环境未正确配置

**解决方案**：
```bash
1. 检查网络连接
2. 确认云开发环境ID配置正确
3. 尝试重新上传
```

### 问题2: 依赖安装失败

**可能原因**：
- npm源速度慢
- 依赖包版本冲突

**解决方案**：
```bash
# 使用淘宝镜像
cd cloudfunctions/pdfToWord
npm install --registry=https://registry.npmmirror.com

# 或使用cnpm
cnpm install
```

### 问题3: 转换时报错 "未找到云函数"

**解决方案**：
1. 确认云函数已上传
2. 检查云函数名称是否为 `pdfToWord`
3. 在云开发控制台确认函数状态

### 问题4: 转换失败 "未找到可提取的文本"

**原因**：选择的是扫描版PDF或图片PDF

**解决方案**：
- 使用文本型PDF（可以选中和复制文字的PDF）
- 扫描版需要先进行OCR识别

### 问题5: 转换超时

**原因**：PDF文件过大或内容复杂

**解决方案**：
- 使用较小的PDF文件（< 10MB）
- 在云函数配置中增加超时时间

```json
// cloudfunctions/pdfToWord/config.json
{
  "permissions": {
    "openapi": []
  },
  "timeout": 60  // 增加超时时间到60秒
}
```

## 📋 测试检查清单

- [ ] 云函数已成功上传
- [ ] 云函数状态显示"已部署"
- [ ] 可以进入PDF转Word页面
- [ ] 可以选择PDF文件
- [ ] 转换选项可以正常切换
- [ ] 测试文件转换成功
- [ ] 可以打开生成的Word文档
- [ ] Word文档内容正确

## 📊 依赖包说明

### 核心依赖

| 包名 | 版本 | 用途 |
|------|------|------|
| wx-server-sdk | ~2.6.3 | 微信云开发SDK |
| pdf-parse | ^1.1.1 | PDF文本提取 |
| docx | ^8.5.0 | Word文档生成 |
| pdf-lib | ^1.17.1 | PDF信息读取 |

### 依赖大小

- 总大小：约 15-20 MB
- 安装时间：2-5 分钟（取决于网络）

## 🎯 性能基准

| 指标 | 数值 |
|------|------|
| 支持最大文件 | 20 MB |
| 转换速度 | ~3-10秒/MB |
| 内存使用 | ~50-200 MB |
| 并发支持 | 根据云函数配额 |

## 🔒 安全配置

### 云函数权限

默认配置下，云函数仅支持：
- 当前环境内调用
- 小程序端调用
- 不支持HTTP调用

如需修改，编辑 `config.json`：
```json
{
  "permissions": {
    "openapi": []
  }
}
```

### 文件访问控制

- 上传的文件默认私有
- 仅有fileID的用户可访问
- 临时链接2小时后失效

## 💡 使用建议

### 推荐使用场景
✅ 电子书文档转换
✅ 报告、论文格式转换
✅ 简单排版的PDF文档
✅ 需要编辑PDF内容

### 不推荐使用场景
❌ 扫描版PDF（需要OCR）
❌ 含大量图片的PDF
❌ 复杂表格为主的PDF
❌ 加密保护的PDF

## 📞 技术支持

如遇到问题：

1. 查看云函数日志
   - 云开发控制台 → 云函数 → pdfToWord → 日志
   
2. 检查前端控制台
   - 开发者工具 → Console 面板

3. 参考完整文档
   - 查看 `README.md` 文件

## 🎉 部署完成

恭喜！PDF转Word功能已成功部署。

现在可以：
- ✅ 开始使用功能
- ✅ 测试不同类型的PDF
- ✅ 收集用户反馈
- ✅ 根据需求优化功能

---

**部署时间**: 2026年2月16日
**文档版本**: 1.0.0
